class KeyboardMapper{constructor(){this.keyMappings=new Map,this.activeKeys=new Set,this.ignoreInputs=["INPUT","SELECT","TEXTAREA"],this.scope="default"}mapCombination(e,t,s="default"){if("string"!=typeof e||"function"!=typeof t)return void console.error("Invalid combination or callback");const n=e.toLowerCase();this.keyMappings.has(n)||this.keyMappings.set(n,[]);const o=this.keyMappings.get(n);o.push({callback:t,scope:s}),document.addEventListener("keydown",(e=>{this.handleKeyUp.bind(this)})),document.addEventListener("keydown",(e=>{const t=this.getKeyFromEvent(e).toLowerCase(),s=this.getScope();o.forEach((o=>{o.scope!==s&&"default"!=o.scope||t!==n||(e.preventDefault(),o.callback(e))}))}))}getScope(){return this.scope}unmapCombination(e){const t=e.toLowerCase();this.keyMappings.delete(t)}handleKeyDown(e){if(this.ignoreInputs.includes(e.target.tagName))return;const t=this.getKeyFromEvent(e);this.activeKeys.add(t),this.executeCallbacks()}handleKeyUp(e){if(this.ignoreInputs.includes(e.target.tagName))return;const t=this.getKeyFromEvent(e);this.activeKeys.delete(t)}executeCallbacks(){const e=Array.from(this.activeKeys).join("+"),t=this.keyMappings.get(e);t&&t.forEach((e=>{const{callback:t,scope:s}=e;if("function"==typeof t){this.getScope()!==s&&"default"!==s||t()}}))}getKeyFromEvent(e){const{key:t,shiftKey:s,ctrlKey:n,altKey:o,metaKey:a}=e;let i="";return(n||a)&&(i+="ctrl+"),s&&(i+="shift+"),o&&(i+="alt+"),i+=t.toLowerCase(),i}setScope(e){this.scope=e}}